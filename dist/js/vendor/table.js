//! JQuery plugin "Compare Table"
!function(t){"use strict";function i(t){this.inited=t.inited||!1,this.columns=t.columns||1,this.lines=t.lines||10,this.folding=t.folding||!1,this.pagination=t.pagination||!1,this.showArrows=t.showArrows||!0,this.prev=t.prev||"<",this.next=t.next||">",this.duplicate=t.duplicate||!1,this.headerFixed=t.headerFixed||!1,this.responsive=t.responsive||!1}i.prototype.init=function(i){if(this.inited)return!1;this.inited=!0,this.table=i,this.currentColumn=0,this.currentPage=1,this.folded=!1,this.qtyLines=this.lines,this.widthPage=window.innerWidth,this.scrollPage=t(window).scrollTop(),this.changeWidthPage=!1,this.changedScrollPage=!1,this.currentBreakpoint=!1;let e='<a href="#" class="tbtn tbtn_prev tbtn_inactive">'+this.prev+"</a>",n='<a href="#" class="tbtn tbtn_next">'+this.next+"</a>";this.showArrows&&this.table.find(".tctrl").prepend(e).append(n),this.headerFixed&&i.addClass("compareTable_headFix"),this.pagination&&this.addPagination(),this.folding&&this.addFolding(),this.update().events()},i.prototype.update=function(){return this.updateBreakpoint().updateColumns().updateSizeColumns().updatePositionColumns().updateVisibleArrows()},i.prototype.updateBreakpoint=function(){let i=!1,e={};if(this.responsive)for(let t=0;t<this.responsive.length;t++){let n=this.responsive[t];window.innerWidth>=n.breakpoint&&(i=n.breakpoint,e=n.settings)}return i!==this.currentBreakpoint&&t.extend(this,e),this},i.prototype.updateColumns=function(){let t="out"===this.duplicate?"*:not(.dupIn)":"";return"in"===this.duplicate?(this.table.find(".dupIn").removeClass("hide"),this.table.find(".dupOut").addClass("hide")):"out"===this.duplicate&&(this.table.find(".dupOut").removeClass("hide"),this.table.find(".dupIn").addClass("hide")),this.allColumns=this.table.find(".tr").eq(0).children(t).length,this.workColumns=this.allColumns<this.columns?this.allColumns:this.columns,this.table.find(".tw").css({"-webkit-box-flex":2*this.workColumns,flex:2*this.workColumns+" 0 0"}),this},i.prototype.updateSizeColumns=function(){return this.workColumns<this.allColumns?(this.table.find(".tr").children().css("width",100/this.workColumns+"%"),this.table.find(".tr").css("width",this.allColumns*(100/this.workColumns)+"%")):(this.table.find(".tr").children().css("width",100/this.allColumns+"%"),this.table.find(".tr").css("width","100%")),this},i.prototype.updatePositionColumns=function(t){let i;return"prev"===t&&this.currentColumn>0?this.currentColumn--:"next"===t&&this.currentColumn<this.allColumns-this.workColumns&&this.currentColumn++,this.currentColumn>this.allColumns-this.workColumns&&(this.currentColumn=this.allColumns-this.workColumns),this.workColumns<this.allColumns?i=-100/this.workColumns*this.currentColumn:(this.currentColumn=0,i=0),this.table.find(".tr").css("left",i+"%"),this.table.find(".tbtn_prev").removeClass("tbtn_inactive"),this.table.find(".tbtn_next").removeClass("tbtn_inactive"),0===this.currentColumn?this.table.find(".tbtn_prev").addClass("tbtn_inactive"):this.currentColumn===this.allColumns-this.workColumns&&this.table.find(".tbtn_next").addClass("tbtn_inactive"),this},i.prototype.updateVisibleArrows=function(){return this.workColumns>=this.allColumns||!this.showArrows?(this.table.find(".tbtn_prev").fadeOut(200),this.table.find(".tbtn_next").fadeOut(200)):this.showArrows&&(this.table.find(".tbtn_prev").fadeIn(200),this.table.find(".tbtn_next").fadeIn(200)),this},i.prototype.updatePositionHeader=function(){let i=window.innerWidth<992?t(".header_bottom").innerHeight():0,e=t(window).scrollTop()+i,n=window.innerHeight,s=this.table.innerHeight(),a=e-this.table.offset().top-10,o=s-this.table.find(".thead").innerHeight()-.3*n;return a>o&&o>0?this.table.find(".thead").css("top",o):a>0?this.table.find(".thead").css("top",a):a<=0&&this.table.find(".thead").css("top",0),this},i.prototype.addPagination=function(){let t=Math.ceil(this.table.find(".tline").length/this.lines),i=this.table.find(".tpaging"),e="",n="";if(t<2)i.remove(),this.currentPage=1,this.qtyLines=this.lines;else{for(let i=1;i<=t;i++)n+='<button class="tpaging__page button button_page" data-value="'+i+'"><span>'+i+"</span></button>",t>6&&(1===i||i===t-1)&&(n+='<span class="tpaging__dots">...</span>');i[0]?this.table.find(".tpaging__pages").html(n):(e+='<div class="tpaging"><button class="tpaging__more button button_more" data-value="more"><span>�������� ���</span><svg width="20" height="20"><use xlink:href="/upload/images/sprite.svg#arrow"></use></svg></button><div class="tpaging__pages">'+n+"</div></div>",this.table.append(e))}return this.applyPagination().updatePagination(),this},i.prototype.changePagination=function(i){let e=t(i),n=e.attr("data-value");return e.hasClass("active")||("more"===n?(this.qtyLines=this.qtyLines+this.lines,this.currentPage++):"next"===n?(this.qtyLines=this.lines,this.currentPage++):"prev"===n?(this.qtyLines=this.lines,this.currentPage--):(this.qtyLines=this.lines,this.currentPage=+n),this.applyPagination().updatePagination()),this},i.prototype.applyPagination=function(){let i=this.table.find(".tline"),e=this.currentPage*this.lines,n=e-this.lines;this.qtyLines!==this.lines&&(n=e-this.qtyLines);for(let s=0;s<i.length;s++){const a=t(i[s]);s>=n&&s<e?a.removeClass("hide"):a.addClass("hide")}return this},i.prototype.updatePagination=function(){let t=Math.ceil(this.table.find(".tline").length/this.lines),i=this.table.find(".tpaging__pages"),e=this.table.find(".tpaging__more"),n=this.table.find(".tpaging__page"),s=this.table.find(".tpaging__dots"),a=this.currentPage;if(i.find("button.active").removeClass("active"),i.find('button[data-value="'+a+'"]').addClass("active"),t===a?e.addClass("hide"):e.removeClass("hide"),a>3?s.eq(0).removeClass("hide"):s.eq(0).addClass("hide"),a<t-2?s.eq(1).removeClass("hide"):s.eq(1).addClass("hide"),t>6)for(let i=1;i<t-1;i++)i>a||i<a-2?n.eq(i).addClass("hide"):n.eq(i).removeClass("hide");return this},i.prototype.addFolding=function(){let t=this.table.find(".thead, .tline").length,i=this.table.find(".tpaging");return t<=this.lines?(i.remove(),this.folded=!1,this.table.removeClass("foldable folded")):i[0]||(this.folded=!0,this.table.addClass("foldable folded").append('<div class="tpaging tpaging_fold"><button class="tpaging__fold folded" data-value="more"><span>����������</span><span>��������</span><svg width="20" height="20"><use xlink:href="/upload/images/sprite.svg#arrow"></use></svg></button></div>')),this.updateFolding(),this},i.prototype.changeFold=function(i){return this.folded?(this.folded=!1,this.table.removeClass("folded"),t(i).removeClass("folded")):(this.folded=!0,this.table.addClass("folded"),t(i).addClass("folded")),this.updateFolding(!0),this},i.prototype.updateFolding=function(t){let i=this.table.find(".thead, .tline"),e=t?200:0;for(let t=0;t<i.length;t++){const n=i.eq(t);t>=this.lines&&this.folded?n.addClass("folded").slideUp(e):n.removeClass("folded").slideDown(e)}return this},i.prototype.addLine=function(i){return this.pagination&&this.table.find(".tpaging")[0]?this.table.find(".tpaging").before(t(i)):this.table.append(t(i)),this.pagination&&this.addPagination(),this.folding&&this.addFolding(),this},i.prototype.checkWidthPage=function(){if(!this.changeWidthPage){this.changeWidthPage=!0;let t=this;setTimeout((function i(){window.innerWidth===t.widthPage?(t.changeWidthPage=!1,t.update()):setTimeout(i),t.widthPage=window.innerWidth}))}},i.prototype.events=function(){let i=this;i.showArrows&&i.table.on("click",".tbtn_prev",(function(t){t.preventDefault(),i.updatePositionColumns("prev")})),i.showArrows&&i.table.on("click",".tbtn_next",(function(t){t.preventDefault(),i.updatePositionColumns("next")})),i.pagination&&i.table.on("click",".tpaging button",(function(t){t.preventDefault(),i.changePagination(this)})),i.folding&&i.table.on("click",".tpaging button",(function(t){t.preventDefault(),i.changeFold(this)})),i.responsive&&t(window).on("resize",(function(){i.checkWidthPage()})),i.headerFixed&&t(window).on("scroll",(function(){i.updatePositionHeader()}))},t.fn.compareTable=function(e){if(!t(this)[0])return console.warn('No elements for create "Compare Table"'),this;t(this).length>1&&console.warn('Use one element for create "Compare Table"');const n=new i(e);return n.init(t(this).eq(0)),n}}(jQuery);